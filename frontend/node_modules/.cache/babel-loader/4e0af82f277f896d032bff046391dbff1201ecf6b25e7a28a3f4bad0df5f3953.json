{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import api from\"../api/api\";import UserDropdown from\"../components/UserDropdown\";import Leaderboard from\"../components/Leaderboard\";import AddUserForm from\"../components/AddUserForm\";import History from\"../components/History\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const HomePage=()=>{const[users,setUsers]=useState([]);const[filteredUsers,setFilteredUsers]=useState([]);const[selectedUser,setSelectedUser]=useState(\"\");const[history,setHistory]=useState([]);const[lastClaimed,setLastClaimed]=useState(null);const[showHistoryModal,setShowHistoryModal]=useState(false);// State to toggle Claim History modal\nuseEffect(()=>{const interval=setInterval(()=>{const fetchUsers=async()=>{const{data}=await api.get(\"/\");setUsers(data);setFilteredUsers(data);// Initialize filtered users\nconst{data:historyData}=await api.get(\"/history\");setHistory(historyData);};fetchUsers();},2000);// Poll every 5 seconds\nreturn()=>clearInterval(interval);},[users,history]);const handleClaimPoints=async()=>{if(!selectedUser)return alert(\"Please select a user\");const{data}=await api.post(\"/claim\",{userId:selectedUser});alert(\"\".concat(data.user.name,\" earned \").concat(data.points,\" points\"));setLastClaimed({name:data.user.name,points:data.points});setUsers(prev=>prev.map(u=>u._id===data.user._id?data.user:u));// Refresh history\nconst{data:historyData}=await api.get(\"/history\");setHistory(historyData);setSelectedUser(\"\");};const addUser=async name=>{const{data}=await api.post(\"/\",{name});setUsers(prev=>[...prev,data]);setFilteredUsers(prev=>[...prev,data]);// Update filtered users\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50  p-4 pt-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-center text-blue-600 mb-6\",children:\"User Points Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center \",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowHistoryModal(true),className:\"bg-blue-500 text-white font-medium px-6 py-2 rounded-lg hover:bg-blue-600 transition\",children:\"View Claim History\"})}),/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-white rounded-lg  \",children:/*#__PURE__*/_jsx(Leaderboard,{users:users})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/3 bg-white p-6 shadow-lg rounded-lg max-h-[28rem] mt-[6rem] mr-6 py-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(UserDropdown,{users:filteredUsers,selectedUser:selectedUser,setSelectedUser:setSelectedUser})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClaimPoints,className:\"bg-blue-500 text-white font-medium px-6 py-2 rounded-lg hover:bg-blue-600 transition w-full mb-10\",children:\"Claim Points\"}),lastClaimed&&/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2 text-green-600 font-medium\",children:[lastClaimed.name,\" earned \",lastClaimed.points,\" points in the last claim.\"]}),/*#__PURE__*/_jsx(AddUserForm,{addUser:addUser})]})]}),showHistoryModal&&/*#__PURE__*/_jsx(History,{history:history,setShowHistoryModal:setShowHistoryModal})]});};export default HomePage;","map":{"version":3,"names":["React","useState","useEffect","api","UserDropdown","Leaderboard","AddUserForm","History","jsx","_jsx","jsxs","_jsxs","HomePage","users","setUsers","filteredUsers","setFilteredUsers","selectedUser","setSelectedUser","history","setHistory","lastClaimed","setLastClaimed","showHistoryModal","setShowHistoryModal","interval","setInterval","fetchUsers","data","get","historyData","clearInterval","handleClaimPoints","alert","post","userId","concat","user","name","points","prev","map","u","_id","addUser","className","children","onClick"],"sources":["C:/Users/karan/OneDrive/Desktop/Backend_assignment/frontend/src/pages/HomePage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport api from \"../api/api\";\r\nimport UserDropdown from \"../components/UserDropdown\";\r\nimport Leaderboard from \"../components/Leaderboard\";\r\nimport AddUserForm from \"../components/AddUserForm\";\r\nimport History from \"../components/History\";\r\n\r\nconst HomePage = () => {\r\n  const [users, setUsers] = useState([]);\r\n  const [filteredUsers, setFilteredUsers] = useState([]);\r\n  const [selectedUser, setSelectedUser] = useState(\"\");\r\n  const [history, setHistory] = useState([]);\r\n  const [lastClaimed, setLastClaimed] = useState(null);\r\n  const [showHistoryModal, setShowHistoryModal] = useState(false); // State to toggle Claim History modal\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      const fetchUsers = async () => {\r\n        const { data } = await api.get(\"/\");\r\n        setUsers(data);\r\n        setFilteredUsers(data); // Initialize filtered users\r\n        const { data: historyData } = await api.get(\"/history\");\r\n        setHistory(historyData);\r\n      };\r\n      fetchUsers();\r\n    }, 2000); // Poll every 5 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [users,history]);\r\n\r\n  const handleClaimPoints = async () => {\r\n    if (!selectedUser) return alert(\"Please select a user\");\r\n\r\n    const { data } = await api.post(\"/claim\", { userId: selectedUser });\r\n    alert(`${data.user.name} earned ${data.points} points`);\r\n    setLastClaimed({ name: data.user.name, points: data.points });\r\n    setUsers((prev) =>\r\n      prev.map((u) => (u._id === data.user._id ? data.user : u))\r\n    );\r\n\r\n    // Refresh history\r\n    const { data: historyData } = await api.get(\"/history\");\r\n      setHistory(historyData);\r\n      setSelectedUser(\"\");\r\n  };\r\n\r\n  const addUser = async (name) => {\r\n    const { data } = await api.post(\"/\", { name });\r\n    setUsers((prev) => [...prev, data]);\r\n    setFilteredUsers((prev) => [...prev, data]); // Update filtered users\r\n  };\r\n\r\n  return (\r\n      <div className=\"bg-gray-50  p-4 pt-6\">\r\n      <h1 className=\"text-3xl font-bold text-center text-blue-600 mb-6\">\r\n        User Points Dashboard\r\n      </h1>\r\n\r\n      {/* Claim History Button */}\r\n      <div className=\"text-center \">\r\n        <button\r\n          onClick={() => setShowHistoryModal(true)}\r\n          className=\"bg-blue-500 text-white font-medium px-6 py-2 rounded-lg hover:bg-blue-600 transition\"\r\n        >\r\n          View Claim History\r\n        </button>\r\n      </div>\r\n      <div />\r\n\r\n      {/* Dashboard Layout */}\r\n      <div className=\"flex gap-8\">\r\n        {/* Left Section: Leaderboard */}\r\n        <div className=\"flex-1 bg-white rounded-lg  \">\r\n          <Leaderboard users={users} />\r\n        </div>\r\n\r\n        {/* Right Section: Dropdown, Claim Points, and Add User */}\r\n        <div className=\"w-1/3 bg-white p-6 shadow-lg rounded-lg max-h-[28rem] mt-[6rem] mr-6 py-6\">\r\n          {/* Dropdown */}\r\n          <div className=\"mb-6\">\r\n            <UserDropdown\r\n              users={filteredUsers}\r\n              selectedUser={selectedUser}\r\n              setSelectedUser={setSelectedUser}\r\n            />\r\n          </div>\r\n          {/* Claim Points Button */}\r\n          <button\r\n            onClick={handleClaimPoints}\r\n            className=\"bg-blue-500 text-white font-medium px-6 py-2 rounded-lg hover:bg-blue-600 transition w-full mb-10\"\r\n          >Claim Points\r\n          </button>\r\n          {lastClaimed && (\r\n            <p className=\"mb-2 text-green-600 font-medium\">\r\n              {lastClaimed.name} earned {lastClaimed.points} points in the last\r\n              claim.\r\n            </p>\r\n          )}\r\n          {/* Add User Form */}\r\n          <AddUserForm addUser={addUser} />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Claim History Modal */}\r\n      {showHistoryModal && (\r\n        <History\r\n          history={history}\r\n          setShowHistoryModal={setShowHistoryModal}\r\n        ></History>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HomePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}